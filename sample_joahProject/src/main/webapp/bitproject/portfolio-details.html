<!DOCTYPE html>
<html>
<head>
<meta charset='UTF-8'>
<title>Hot place</title>
<link rel="stylesheet" href="../lib/bootstrap/css/bootstrap.css">
<!-- <link rel="stylesheet" href="../css/common.css"> -->
<link rel="stylesheet" type="text/css" href="../lib/mycss/style_detail.css" />
<link rel="stylesheet" type="text/css" href="../lib/mycss/style_header.css" />
    <script type="text/javascript" src="js/jquery.js"></script>
    <script type="text/javascript" src="js/bootstrap.min.js"></script>
    <script type="text/javascript" src="js/lightbox.min.js"></script>
    <script type="text/javascript" src="js/wow.min.js"></script>
    <script type="text/javascript" src="js/main.js"></script> 
<script type="text/javascript" src="../lib/myjs/jquery-ui.min.js"></script>
<script type="text/javascript" src="../lib/myjs/jquery-1.3.2.min.js"></script>
<script type="text/javascript" src="../lib/myjs/modernizr.js"></script>



<link href="css/bootstrap.min.css" rel="stylesheet">
<link href="css/font-awesome.min.css" rel="stylesheet">
<link href="css/lightbox.css" rel="stylesheet">
<link href="css/animate.min.css" rel="stylesheet">
<link href="css/main.css" rel="stylesheet">
<link href="css/responsive.css" rel="stylesheet">
    
</head>
<body>
<div id="main_container">
      
      
        <!-- header -->
<header id="h_title"></header>

<script type="text/javascript" src="../lib/jquery/jquery.js"></script>
<script>
$.ajax({
    url : "header.html",
    dataType : "html",
    type : "get",  // post 또는 get
    success : function(result){
        $("#h_title").html(result);
    }
});
</script>

  <div class="center_content_pages">
    <div class="pages_banner">DETAIL</div>
  </div>

  <section id="portfolio">
      <div class="right_content">
        <h1>
          <label class="h23">No</label>
          <label id ="data_no" class="h23"></label>
          <label class="h23">&#41;&#09;&#09;</label>
          <label id ="data_title" class="h23"></label>
        </h1>
            <div id="testMap" style="width: 800px; height: 400px; margin: 10px 0 0 0;"></div>
         </div>

             <div class="left_content">
         <label style="margin: 15px 0 15px 15px; font-size: 30px; ">Category</label>
        <div class="sidebar blog-sidebar">
          <div class="sidebar-item categories">
            <ul class="nav navbar-stacked">
              <li><a>1 location<span class="pull-right"></span></a></li>
              <li><input style="border-radius:13px;"type="text"></li>
              <li><a>2 location<span class="pull-right"></span></a></li>
              <li><input style="border-radius:13px;"type="text"></li>
              <li><a>3 location<span class="pull-right"></span></a></li>
              <li><input style="border-radius:13px;"type="text"></li>
              <li><a>4 location<span class="pull-right"></span></a></li>
              <li><input style="border-radius:13px;"type="text"></li>
              <li><a>5 location<span class="pull-right"></span></a></li>
              <li><input style="border-radius:13px;"type="text"></li>
              <li><a>6 location<span class="pull-right"></span></a></li>
              <li><input style="border-radius:13px;"type="text"></li>
            </ul>
           </div>
        </div>
      </div>
    </section>
    
    <!-- 밑줄 한줄 -->
    <div>
      <hr style="position:relative; width:90%; border-top: 2px solid lightgray; ">
    </div>
    <!-- 밑줄 한줄 끝 -->
    
    <section>
      <div class="row pictures_div">
                <div class="col-sm-6 wow fadeInDown" data-wow-duration="1000ms" data-wow-delay="0ms" id="photo_div">
<!-- 사진 ajax 들어감 -->
                </div>
                <div class="col-sm-6 wow fadeInDown row" data-wow-duration="1000ms" data-wow-delay="0ms">
                    <h2>PHOTO</h2>
                        <div style="border:1px solid gray" class="wow fadeInUp col-sm-4" data-wow-duration="900ms" data-wow-delay="100ms">
                        <img src="images/portfolio/1.jpg"></div>
                        <div style="border:1px solid gray" class="wow fadeInUp col-sm-4" data-wow-duration="800ms" data-wow-delay="200ms">
                        <img src="images/portfolio/2.jpg"></div>
                        <div style="border:1px solid gray" class="wow fadeInUp col-sm-4" data-wow-duration="700ms" data-wow-delay="300ms">
                        <img src="images/portfolio/3.jpg"></div>
                        <div style="border:1px solid gray" class="wow fadeInUp col-sm-4" data-wow-duration="600ms" data-wow-delay="100ms">
                        <img src="images/portfolio/4.jpg"></div>
                        <div style="border:1px solid gray" class="wow fadeInUp col-sm-4" data-wow-duration="500ms" data-wow-delay="200ms">
                        <img src="images/portfolio/5.jpg"></div>
                        <div style="border:1px solid gray" class="wow fadeInUp col-sm-4" data-wow-duration="400ms" data-wow-delay="300ms">
                        <img src="images/portfolio/6.jpg"></div>
                    
                </div>
            </div>
    </section>
    <div>
      <hr style="position:relative; width:90%; border-top: 2px solid lightgray;">
    </div>

    <section>
      <div class="post-content overflow">
        <h2 class="post-title bold">
          <a id ="data_title2"></a>
        </h2>
        <h3 class="post-author">
          <a>Posted by micron News</a>
        </h3>
        <p id="content">
        </p>
        <div class="post-bottom overflow">
          <ul class="nav navbar-nav post-nav">
            <li><a><i class="fa fa-tag"></i>Creative</a></li>
            <li><a><i class="fa fa-heart"></i>32 Love</a></li>
            <li><a><i class="fa fa-comments"></i>3 Comments</a></li>
          </ul>
        </div>
        <div class="blog-share">
          <span class='st_facebook_hcount'></span> <span
            class='st_twitter_hcount'></span> <span class='st_linkedin_hcount'></span>
          <span class='st_pinterest_hcount'></span> <span
            class='st_email_hcount'></span>
        </div>
        <div class="author-profile padding">
          <div class="row">
            <div class="col-sm-2">
              <img src="images/blogdetails/1.png" alt="">
            </div>
            <div class="col-sm-10">
              <h3>Rodrix Hasel</h3>
              <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit,
                sed do eiusmod tempor incididunt ut labore et dolore magna aliq
                Ut enim ad minim veniam, quis nostrud exercitation ullamco
                laboris nisi</p>
              <span>Website:<a href="www.jooomshaper.com">
                  www.jooomshaper.com</a></span>
            </div>
          </div>
        </div>
        
        <div class="response-area">
          <h2 class="bold">Comments</h2>

          <form method="post" action="#" data-ajax="true">
            <div class="row">
              <div class="col-sm-2">
                <img class="img-circle" src="1.png" width="127" height="137"
                  alt="">
              </div>

              <div class="col-sm-9">
                <dl class="comment_form_content">
                  <dt>댓글 본문</dt>
                  <dd>
                    <div id="reply_indicator">
                      <input type="hidden" name="parent" value="">
                    </div>
                    <textarea style="display:none" id="com-content" class="form-control" rows="3" name="cmt_content" placeholder="댓글 달리는 영역"></textarea>
                    <textarea style="display:none" id="com-content2" class="form-control" rows="3" name="cmt_content" placeholder="로그인 한 후 이용 가능" readonly></textarea>
                  </dd>
                </dl>
                <div class="buttons" style="float:right;">
                  <input type="hidden" name="course_id" value="45"> <input
                    type="hidden" name="module_id" value="0"> <input
                    type="hidden" name="topic_id" value="0">

                  <button type="button" id="comment-add-btn" class="btn btn-success">
                    <span>댓글 올리기</span>
                  </button>
                </div>
              </div>
            </div>
          </form>
          <!-- 댓글 DB 연동  -->
          <ul id="commentList" class="media-list wow fadeInDown" >
          
          </ul>
      </div>
      </div>
      </section>
    </div>
    
<script type="text/javascript" src="../lib/jquery/jquery.min.js"></script>
  <script>
 var no = location.href.split('?')[1].split('=')[1];

 $.getJSON('ajax/detail.do?no=' + no, function(resultObj) {
    var ajaxResult = resultObj.ajaxResult;
    if (ajaxResult.status == "success") {
      var board = ajaxResult.data;
      $("#photo_div").html("<img src='images/portfolio/"+ board.photo +"' class='img-responsive' alt=''>")
      $("#data_title").text(board.title);
      $("#data_title2").text(board.title);
      $("#data_no").text(board.no);
      $("#content").text(board.content);
    }
 });
 
 $.getJSON('ajax/comment.do?no=' + no, function(resultObj) {
       var com = $("#commentList");
       var count = 100;
       var dt, year, month, day, hour, minute, second, time;
      for (var comment of resultObj.data) {
         dt = new Date(comment.createdTime);
        year = dt.getYear();
        month = dt.getMonth() + 1;
        day = dt.getDate();
        hour = dt.getHours();
        minute = dt.getMinutes();
        second = dt.getSeconds();
        time = month + "월 " + day + "일 " + hour + "시" + minute + "분";
        $('<li id="comment_li'+comment.cno+'" class="media">')
        .html('<div class="post-comment wow fadeInDown" data-wow-duration="'+count+'ms" data-wow-delay="800ms">' +
        '<a class="pull-left"> <img class="media-object"' +
        'src="'+ comment.photo +'" alt="">' +
        '</a>' +
        '<div class="media-body">' +
        '<span><i class="fa fa-user"></i>Posted by <a>'+ comment.id +'</a></span>' +
        '          <p>'+ comment.content +'</p>' +
        '          <ul class="nav navbar-nav post-nav">' +
         '           <li><a><i class="fa fa-clock-o"></i>'+ time +'</a></li>' +
        '            <li><div class="deletecomment" id="comment' + comment.cno + '"><i class="fa fa-reply"></i>삭제</div></li>' +
      '            </ul>' +
       '         </div>' +
       '       </div></li>').appendTo(com);
        count += 100;
        $("#comment" + comment.cno).click(function(event) {
               var commentNo = $(this).attr("id").split('comment')[1];
                console.log(commentNo);
               $.getJSON('ajax/deletecomment.do?no='+ commentNo + '&id='+ sessionStorage.getItem('loginSession'), function(resultObj) {
                       var ajaxResult = resultObj.ajaxResult;
                       if (ajaxResult.status == "success") {
                          $("#comment_li"+commentNo).remove();
                          alert("게시물 삭제하였습니다.");
                       } else {
                          alert("게시 삭제에 실패했습니다.");
                      }
               });
            });
      }
   });

 $("#comment-add-btn").click(function(event) {
   $.post('ajax/addcomment.do', {
        id: sessionStorage.getItem('loginSession'),
        bno: no,
        content: $('#com-content').val(),
        success:function(data) {
        }
      }, function(resultObj) {
        var ajaxResult = resultObj.ajaxResult;
        if (ajaxResult.status == "success") {
           var com = $("#commentList");
           $('<li id="comment_li_new" class="media">')
           .html('<div class="post-comment wow fadeInDown" data-wow-duration="100ms" data-wow-delay="800ms">' +
            '<a class="pull-left"> <img class="media-object"' +
            'src="default.jpg" alt="">' +
            '</a>' +
            '<div class="media-body">' +
            '<span><i class="fa fa-user"></i>Posted by <a>'+ sessionStorage.getItem('loginSession') +'</a></span>' +
            '          <p>'+ $('#com-content').val() +'</p>' +
            '          <ul class="nav navbar-nav post-nav">' +
             '           <li><a><i class="fa fa-clock-o"></i> 방금 전</a></li>' +
            '            <li><div class="deletecomment" id="comment_li_new"><i class="fa fa-reply"></i>삭제</div></li>' +
          '            </ul>' +
           '         </div>' +
           '       </div></li>').prependTo(com);
        } 
      }, 'json');
    });
 
 $(".deletecomment").click(function(event) {
   console.log("버튼 눌렀을 때 반응");
   /* $.postJSON('ajax/deletecomment.do?no=', function(resultObj) {
     console.log($('#comment-no').val('value'));
          var ajaxResult = resultObj.ajaxResult;
          if (ajaxResult.status == "success") {
              alert("삭제 성공")
            } else {
            alert("게시물 삭제에 실패했습니다.");
          }
    }); */
 });
 
 /* 로그인 안한 사람 댓글 달 수 없어요.
    로그인 한 사람은 댓글에 아이디 뜨게 하기*/
   if(sessionStorage.getItem('loginSession') != undefined) {
     $('#before_login').val(sessionStorage.getItem('loginSession'));
  } else {
     $('#after_login')
  } 
  
  </script>

</body>
</html>