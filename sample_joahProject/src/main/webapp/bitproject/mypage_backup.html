<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="">
<meta name="author" content="">
<title>JOAH | by One Point</title>
<link href="css/bootstrap.min.css" rel="stylesheet">
<link href="css/font-awesome.min.css" rel="stylesheet">
<link href="css/animate.min.css" rel="stylesheet">
<link href="css/main.css" rel="stylesheet">
<link href="css/responsive.css" rel="stylesheet">
	<link rel="stylesheet" href="css/admin_member.css" type="text/css">
<link rel="stylesheet" type="text/css" href="../lib/mycss/style_mypage.css" />
<link rel="stylesheet" type="text/css" href="../lib/mycss/style_header.css" />
<script type="text/javascript" src="../lib/myjs/modernizr.js"></script>

<script type="text/javascript" src="js/jquery-1.11.3.js"></script>
<script type="text/javascript" src="js/bootstrap.min.js"></script>
<script type="text/javascript" src="js/main.js"></script>
<script type="text/javascript" src="js/wow.min.js"></script>
</head>
<!--/head-->

<body>
	<div id="main_container">
		<header id="h_title"></header>

<script>
$.ajax({
    url : "header.html",
    dataType : "html",
    type : "get",  // post 또는 get
    success : function(result){
        $("#h_title").html(result);
     }
});
</script>
		<div class="center_content_pages">
			<div class="pages_banner">MY PAGE</div>
		</div>

		<!-------Side Menu Bar 시작------>
		<section style="padding-top: 30px;">

			<div class="row" id="row_mypage">
				<div id='cssmenu' class='col-xs-3'>
					<ul id="menubar">
						<li><a><span>회원 정보</span></a>
							<ul>
								<li><a id="my_couple"><span>커플 정보</span></a></li>
								<li><a id="my_filter"><span>회원 정보 변경</span></a></li>
								<li><a id="my_pwd"><span>비밀번호 변경</span></a></li>
								<li><a id="my_secession"><span>회원 탈퇴</span></a></li>
							</ul></li>
						<li><a><span>마이 리스트</span></a>
							<ul>
								<li><a href='#'><span>나의 찜목록</span></a></li>
								<li><a href='my_ing.html'><span>후기 미작성</span></a></li>
								<li><a href='my_board.html'><span>내가 작성한 게시물</span></a></li>
							</ul></li>
						<li><a><span>문의</span></a>
							<ul>
								<li><a href=''><span>1:1 문의</span></a></li>
							</ul></li>
					</ul>
				</div>
				<!-------Side Menu Bar 끝------>
				<div class="col-xs-9">
					<div id="couple_info"></div>
						<div id="couple">
						  <h1 class="margin-bottom">커플 정보</h1>
						  <div style="margin-left: 20px;">
						    <p>
							    <label><span>소중한 사람의 정보를 볼 수 있는 곳 입니다.</span>
							    <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
							       커플을 신청하세요!</span></label><br>
							    <span>너와 나의 </span>
								<span style="color: skyblue;"><b>가입 정보</b></span>
								<span>를 볼 수 있습니다.</span><br><br>
							</p>
						  </div>       
				        <div class="col-xs-6" style="position: relative;">
				            <div class="profile text-center">
				           		<img src="images/aboutus/default.jpg" class="img_mypage">
				            </div>
				   
				           <div class="center_content">
				         <label style="margin: 15px 0 15px 0px; font-size: 30px; padding-left:20px;">내 정보</label>
				        <div class="sidebar blog-sidebar">
				          <div class="sidebar-item categories" style="position: ">
				            <ul class="nav navbar-stacked" style="margin-top:-5px;padding-top:3px;border-top: 3px solid #80828c;">
				              <li><a>ID<input id="member_id" style="border-radius:13px;"type="text" readonly></a></li>
				              <!-- <li><a>Password<input style="border-radius:13px;"type="text"></a></li>
				              <li><a>Password Check<input style="border-radius:13px;" type="text"></a></li> -->
				              <li><a>Name<input id="member_name" style="border-radius:13px;"type="text" readonly></a></li>
				              <li><a>E-Mail<input id="member_email" style="border-radius:13px;"type="text" readonly></a></li>
				              <li><a>Gender<input id="member_gender" style="border-radius:13px;"type="text" readonly></a></li>
				              <li><a>Age<input id="member_age" style="border-radius:13px;"type="text" readonly></a></li>
				              <!-- <li><a>Couple ID<input id="member_cid" style="border-radius:13px;"type="text"></a></li>
				             --></ul>
				           </div>
				        </div>
				      </div>
				     </div>
				     
				       <div class="col-xs-6 solo_heaven" style="position: relative;">
				       		<div>
				       		  <form id="form1">
							    <select name='search'>
							    <option value="id">아이디</option>
							    </select>
							    <input type="text" name="word">
		 					    <input type="submit" value="검색">
	 						  </form>
	 						</div><br><br>
				       		<div id="test1111"></div>
				   
				           <div class="center_content search_id"> </div>
				            <button type='button' id='requestCouple'>커플 신청</button>
				            <button type='button' id='cancleCouple'>커플 신청 취소</button>	
				        	
				       <!--  
				       <div class="profile text-center">
				            	<img src="images/aboutus/default.jpg" class="img_mypage" alt="">
				            </div>
				         <label style="margin: 15px 0 15px 0px; font-size: 30px; padding-left:20px;"/>상대 정보</label>
				       <div class="sidebar blog-sidebar">
				          <div class="sidebar-item categories" style="position: ">
				            <ul class="nav navbar-stacked" style="margin-top:-5px;padding-top:3px;border-top: 3px solid #80828c;">
				              <li><a>ID<input id="member_id2" style="border-radius:13px;"type="text" readonly></a></li>
				              <li><a>Name<input id="member_name" style="border-radius:13px;"type="text"></a></li>
				              <li><a>Gender<input id="member_gender" style="border-radius:13px;"type="text"></a></li>
				              <li><a>Age<input id="member_age" style="border-radius:13px;"type="text"></a></li>
				            </ul>
				           </div>
				        </div>	 -->
				      
				      </div> 
						
				       <!--  <div class="col-xs-6" style="position: relative;">
				            <div class="profile text-center">
				            	<img src="images/aboutus/default.jpg" class="img_mypage" alt="">
				            </div>
				   
				           <div class="center_content">
				         <label style="margin: 15px 0 15px 0px; font-size: 30px; padding-left:20px;">애인 정보</label>
				        <div class="sidebar blog-sidebar">
				          <div class="sidebar-item categories" style="position: ">
				            <ul class="nav navbar-stacked" style="margin-top:-5px;padding-top:3px;border-top: 3px solid #80828c;">
				              <li><a>ID<input id="member_id2" style="border-radius:13px;"type="text" readonly></a></li>
				              <li><a>Password<input style="border-radius:13px;"type="text"></a></li>
				              <li><a>Password Check<input style="border-radius:13px;" type="text"></a></li>
				              <li><a>Name<input id="member_name" style="border-radius:13px;"type="text"></a></li>
				              <li><a>E-Mail<input id="member_email" style="border-radius:13px;"type="text"></a></li>
				              <li><a>Gender<input id="member_gender" style="border-radius:13px;"type="text"></a></li>
				              <li><a>Age<input id="member_age" style="border-radius:13px;"type="text"></a></li>
				              <li><a>Couple ID<input id="member_cid" style="border-radius:13px;"type="text"></a></li>
				            </ul>
				           </div>
				        </div>
				      </div>
				      </div> -->
				      
				    </div>
				</div>
			</div>
		</section>

	</div>
	<script>
	var myName = '';
$.getJSON('ajax/detailmember.do?id=' + sessionStorage.getItem('loginSession'), function(resultObj) {
  var ajaxResult = resultObj.ajaxResult;
  if (ajaxResult.status == "success") {
    var member = ajaxResult.data;
    /* $("#photo_div").html("<img src='images/portfolio/"+ member.photo +"' class='img-responsive' alt=''>") */
    $("#member_id").val(sessionStorage.getItem('loginSession'));
    $("#member_pwd").val(member.pwd);
    $("#member_name").val(member.name);
    myName = member.name;
    console.log(myName);
    $("#member_email").val(member.email);
    $("#member_gender").val(member.gender);
    $("#member_age").val(member.age);
    $("#member_cid").val(member.cid);
  }
}); 

var search = '';
var word = '';
if (location.href.indexOf('?') != -1) {
	search = location.href.split('?')[1].split('=')[1].split('&')[0];
	word = location.href.split('&')[1].split('=')[1];
}

if (word != '' && search !='') {
	$.getJSON('ajax/member/list.do?search=' + search + '&word=' + word , function(resultObj) {
		var table = $('#test1111');
		 for (var member of resultObj.data) {
			 
			 var photo = member.photo;
			 
			 if (photo == null || photo == '') {
				 photo = 'default.jpg';
			 }
			 
			$("#test1111")
			.html("<label style='margin: 15px 0 15px 0px; font-size: 30px; padding-left:20px;'/>검색 정보</label><br><br><br>"
				+ "<div class='profile text-center'>"	
				+ "<div class='sidebar-item categories' style='position:'>"
	            + "<ul class='nav navbar-stacked' style='margin-top:-5px;padding-top:3px;border-top: 3px solid #80828c;'><br><br>"
	            + "<br><br><img src='../profile_image/" + photo +"' class='img_mypage' alt=''>"
	            + "</div><div>아이디(이름) : "
	            + "<input value='     "  + member.id  + "(" + member.name + ")' style='border-radius:13px;'type='text' readonly></div><br>"
	            + "<div>나이 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;<input value='           "  + member.age  
	            + "' style='border-radius:13px;'type='text' readonly></div><br>"
	            ).appendTo(table);
		 }
	});
}

$('#requestCouple').click(function(event) {
	
	var my_Id = sessionStorage.getItem('loginSession');
	var IdCheck = 0;
	
	console.log("상대방아이디" + word);
	console.log("내이메일" + my_Id);
		
	 $.getJSON('ajax/CR/idcheck.do', function(resultObj){
	    for (var couple_request of resultObj.data) {
	      if(my_Id == couple_request.my_id){
	    	  IdCheck = 1;
	      }
	    }
	    console.log(IdCheck);
	    if (IdCheck!=1) {
		    	$.post('ajax/CR/add.do', {	
				my_id : my_Id,
				my_name : myName,
				request_id : word,
			    }, function(resultObj) {
				var ajaxResult = resultObj.ajaxResult;
				if (ajaxResult.status == "success") {
					alert("커플 신청 성공.");
					location.href = "mypage.html";
				} else {
					alert("이미 커플중이거나 커플 신청상태 입니다.");
				}
			}, 'json');  
	    } else {
	    	alert("이미 커플중이거나 커플 신청상태 입니다.");
	    }
	}) 
});

$('#cancleCouple').click(
		function(event) {
			var my_Id = sessionStorage.getItem('loginSession')
			$.getJSON('ajax/CR/delete.do?my_id=' + my_Id, function(resultObj) {
				console.log("커플신청 취소함.");
				var ajaxResult = resultObj.ajaxResult;
				if (ajaxResult.status == "success") {
					alert("커플 신청 취소 성공.");
					location.href = "mypage.html";
				} else {
					alert("커플 신청 중이 아닙니다.");
				}
			})
		});
</script>
<script>

/* $("#h_title").load("load/header.html"); */

$(function () {
  $('#menubar a').click(function() {
    $('#couple_info').load('load/' + $(this).attr('id') + '.html');
    $('#couple').empty();
  });
});

 </script>


</body>
</html>